{% extends "base.html" %}
{% block title %}Instructor Details{% endblock %}

{% block content %}

<h2 class="mb-3">
  {{ instructor.first_name }} {{ instructor.last_name }}
</h2>

<ul class="list-group mb-4">

  <li class="list-group-item">
    <strong>Email:</strong> {{ instructor.email }}
  </li>

  <li class="list-group-item">
    <strong>Title:</strong> {{ instructor.title if instructor.title else '-' }}
  </li>

  <li class="list-group-item">
    <strong>Department:</strong> {{ instructor.department_name }}
  </li>

  <!-- NEW: Instructor Status -->
  <li class="list-group-item">
    <strong>Status:</strong>
    {% if instructor.status == 'Active' %}
    <span class="badge bg-success">Active</span>
    {% else %}
    <span class="badge bg-secondary">Inactive</span>
    {% endif %}
  </li>

</ul>

<div class="mb-3">
  <a href="{{ url_for('main.edit_instructor', instructor_id=instructor.instructor_id) }}" class="btn btn-warning">
    Edit
  </a>

  {% if instructor.status == 'Active' %}
  <form action="{{ url_for('main.delete_instructor', instructor_id=instructor.instructor_id) }}" method="POST"
    style="display:inline;">
    <button class="btn btn-danger ms-2">Delete</button>
  </form>
  {% endif %}

  <a href="{{ url_for('main.instructor_list') }}" class="btn btn-secondary ms-2">
    Back to instructor list
  </a>
</div>

<hr>

<h3 class="mb-3">Courses Taught by This Instructor</h3>

{% if courses %}
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Code</th>
      <th>Name</th>
      <th>Enrollment</th>
      <th>Status</th>
      <th>View</th>
    </tr>
  </thead>

  <tbody>
    {% for c in courses %}
    <tr class="{% if c.status != 'Active' %}table-secondary{% endif %}">
      <td>{{ c.course_code }}</td>
      <td>{{ c.course_name }}</td>

      <td class="{% if c.enrolled_count >= c.capacity %}text-danger fw-bold{% endif %}">
        {{ c.enrolled_count }}/{{ c.capacity }}
      </td>

      <td>
        {% if c.status == 'Active' %}
        <span class="badge bg-success">Active</span>
        {% else %}
        <span class="badge bg-secondary">Inactive</span>
        {% endif %}
      </td>

      <td>
        <a href="{{ url_for('main.course_detail', course_id=c.course_id) }}" class="btn btn-sm btn-info">
          View Course
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>This instructor is not currently assigned to any courses.</p>
{% endif %}

{% endblock %}